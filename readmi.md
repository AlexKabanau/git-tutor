first commit

Refactor error handling

Update JWT token logic